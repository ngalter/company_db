`DROP TEMPORARY TABLE IF EXISTS etemp; CREATE TEMPORARY TABLE etemp SELECT IFNULL(CONCAT(m.last_name, ', ', m.first_name),'None') AS 'Manager', e.role_id, e.manager_id, CONCAT(e.last_name, ', ', e.first_name) AS 'Employee' FROM employee e LEFT JOIN employee m ON m.id = e.manager_id; SELECT etemp.Employee, role.title, etemp.Manager FROM etemp INNER JOIN role ON role.id = etemp.role_id`
